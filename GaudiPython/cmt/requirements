package GaudiPython
version v9r4

branches      GaudiPython cmt doc src

use GaudiKernel        v*
use GaudiAlg           v* 
use GaudiUtils         v* 
use AIDA               v*  LCG_Interfaces
use CLHEP              v*  LCG_Interfaces -no_auto_imports
use Python             v*  LCG_Interfaces -no_auto_imports
use Reflex             v*  LCG_Interfaces -no_auto_imports

apply_pattern install_more_includes more=GaudiPython
apply_pattern install_python_modules


#-------Applications and Libraries-----------------------------------------------
library GaudiPythonLib   Lib/*.cpp      -import=Python -import=CLHEP
library GaudiPython      Services/*.cpp -import=Python -import=CLHEP
apply_pattern  linker_library    library=GaudiPythonLib 

#-------LCG Dictionaries---------------------------------------------------------
apply_pattern reflex_dictionary dictionary=GaudiPython \
                                headerfiles=$(GAUDIPYTHONROOT)/dict/kernel.h \
                                selectionfile=../dict/selection_kernel.xml \
                                options="--no_templatetypedefs -I$(Python_inc)" \
                                imports="Python -import=CLHEP"

#-------Running Options----------------------------------------------------------
path_remove  PYTHONPATH "/GaudiPython/" WIN32 "\GaudiPython\"
path_prepend PYTHONPATH "$(GAUDIPYTHONROOT)/python"
#path_remove  LD_LIBRARY_PATH /GaudiPython/ WIN32
#path_prepend LD_LIBRARY_PATH ${GAUDIPYTHONROOT}/${BINDIR} WIN32
#path_remove  PATH "" WIN32 "\GaudiPython\"
#path_prepend PATH "" WIN32 ${GAUDIPYTHONROOT}/${BINDIR}

#--------------------------------------------------------------------------------
private
apply_pattern  component_library library=GaudiPython

#--------------------------------------------------------------------------------
use GaudiSvc v* -no_auto_imports
use GaudiAlg v* -no_auto_imports
#include_dirs "$(GAUDIPYTHONROOT)"
#apply_pattern package_Cshlibflags

###--- Test library
library GPyTest  -group=tests   Test/*.cpp -import=CLHEP
apply_pattern library_Cshlibflags library="GPyTest"

###--- Test dictionary
macro testdict_options "--no_templatetypedefs -I$(Python_inc) -I$(GAUDIPYTHONROOT)/src/Test"
apply_pattern reflex_test_dictionary dictionary=GPyTest \
                                     headerfiles=$(GAUDIPYTHONROOT)/src/Test/test.h \
                                     selectionfile=../src/Test/test_selection.xml \
                                     options=$(testdict_options) \
                                     imports="Python -import=CLHEP"

# The reflex_test_dictionary pattern defined in LCGCMT's Reflex Interface
# assumes the use of a different library CMT fragment that supports the
# -libdirname option. To work around this we have to override the definition
# of the GPyTest_rootmap macro defined by the pattern.

# This line is needed to work with both ROOT 5.14 (LCG <= 53*) and ROOT 5.15 (LCG >= 54) 
macro rootmap_name "rootmap" ROOT_GE_5_15 "reflex.rootmap"
macro test_GPyTest_rootmap   $(GAUDIPYTHONROOT)/$(tag)/$(rootmap_name) \
      GAUDI_with_installarea $(CMTINSTALLAREA)/$(tag)/lib/$(rootmap_name) \
      GAUDIATLAS_with_installarea $(CMTINSTALLAREA)/$(tag)/lib/$(rootmap_name)

# This line bellow is needed for ROOT 5.18
macro_append ROOT_linkopts " -lPyROOT " WIN32 " libPyROOT.lib "

